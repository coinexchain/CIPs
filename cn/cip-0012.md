| cip  | title                            | author | status |
| ---- | -------------------------------- | ------ | ------ |
| 0012 | 冷热钱包通过二维码进行交互的规范 |        | 草案   |

## 概述

用户需要使用不联网的手机来保存私钥、签署交易，这台手机就相当于一个冷钱包。冷钱包同联网的热钱包的通讯，完全依靠扫描对方屏幕上的二维码来进行。

## 背景

将私钥保存在联网的设备上，存在被黑客攻击、窃走密钥的风险，因此保存大额的数字货币，使用冷钱包会比较安全。使用旧手机作为冷钱包是价格低廉的方案，同时也是规避硬件钱包被“供应链攻击”的好办法。

## 目的

本文规范了经由二维码来传输的文本的格式，这样不同钱包App厂商所开发的冷热钱包，可以相互沟通、混合使用。

## 规范

本文目前只规范了普通的转账交易如何通过冷钱包进行签署。

通过二维码从热钱包传送到冷钱包的字符串，是以json格式表示的一个字典（map），其中各个key的说明如下：

1. accountNumber：待签署此交易的账户的accountNumber，此信息在生成签名时要用到
2. sequence： 待签署此交易的账户的当前的sequence，此信息在生成签名时要用到
3. amount：转账金额，注意这里的100000000（一亿）表示一个币。
4. coinName：被转账的Token的名称
5. from：付款账号的bech32地址
6. to：收款账号的bech32地址
7. fee：本转账交易支付给Validators的手续费
8. gas：本转账交易所消耗的Gas
9. memo：备忘信息，如果收款账户是交易所账户，这里要填写交易所账户

热钱包显示的二维码所表示的json串必须是无空白字符（空格、换行、Tab）的。

以下是一个例子，为了展示的方便，加入了换行和Tab：

```json
{
	"accountNumber":104,
	"sequence":185,
	"amount":1000000000,
	"coinName":"CET",
	"from":"coinex1...",
	"to":"coinex1...",
	"fee":2000000,
	"gas":100000,
	"memo":""
}
```



通过二维码从冷钱包传送到热钱包的字符串，是以json格式表示的一个字典（map），其中各个key的说明如下：

2. fee：交易手续费（来自输入到冷钱包的json串中的fee和gas）
	1. amount：以CET计价的手续费数额
		1. amount：一个整数，表示手续费的数量
		2. denom：这里只能是"cet"
	2. gas：本转账交易所消耗的Gas，是一个整数
3. memo：备忘信息（来自输入到冷钱包的json串中的memo）
4. msg：一个Json的列表，目前只有一个字典entry，其中的各个Key的说明如下
	1. type：对于转账，它只能是"bankx/MsgSend"
	2. value：一个字典，其中的各个Key的说明如下
		1. amount：一个字典，其中的各个Key的说明如下
		   1. amount：转账的金额，一个整数
		   2. denom：被转账的Token的名称
		2. from_address：付款账号的bech32地址
		3. to_address：收款账号的bech32地址
		4. unlock_time: 目前必须是"0"（不支持通过冷钱包签署锁定转账交易）
5. signatures：签名信息，这是一个字典，其中的各个Key的说明如下
	1. pub_key：公钥信息
		1. type：公钥类型，目前只能是"tendermint/PubKeySecp256k1"
		2. value：公钥的数值，以base64编码的字节串
	2. signature：签名的数值，以base64编码的字节串



冷钱包显示的二维码所表示的json串必须是无空白字符（空格、换行、Tab）的。

以下是一个例子，为了展示的方便，加入了换行和Tab：


```json
{
	"fee":{"amount":[{"amount":"2000000","denom":"cet"}],
		"gas":"100000"},
	"memo":"",
	"msg":[
		{"type":"bankx/MsgSend",
		"value":{"amount":[{"amount":"1000000000","denom":"cet"}],
			"from_address":"coinex1...",
			"to_address":"coinex1...",
			"unlock_time":"0"
			}
		}
	],
	"signatures":[
		{"pub_key":{
			"type":"tendermint/PubKeySecp256k1",
			"value":"AoPytzskEFDgcyo83kMnZLDhyug8fWLpSuKT29Y1w5c8"
			},
		"signature":"……"
		}
	]
}
```
