cip | title | author | status
-----|-----|-----|----
0007|订单撤销规则变更| | 草案

## 概述

在中心化交易所上，用户指定订单期望成交的价格，一段时间后，用户觉得价格不合适，可以通过交易所的撤销订单指令，来撤销这笔订单。

在`coinex-dex`公链上，也提供类似的订单体验；同时`coinex-dex`作为一个链上的去中心化交易所，提供了另一种限时类型的订单(GTE)，即用户可以设置订单在链上存在的区块数，当用户设定的时间到期时，订单还未成交，则链上订单引擎会自动将该订单从链上删除；但是在保障链性能的前提下，所有到期订单自动删除的时间，统一放在了UTC 0点(即北京时间早晨08:00)。

## 目的

在`coinex-dex v0.1.0`版本及它之前，GTE过期订单的自动删除需要满足两个条件

*   UTC 0点
*   在链上存在至少100000(`gte_order_lifetime`) 区块；
    *   原因是：系统允许每笔订单在链上免费存在100000(`gte_order_lifetime`)个区块；所以订单引擎在删除订单时，默认查询了`gte_order_lifetime`个区块以前的订单，检查它们是否到期，然后再进行删除；导致当一笔订单设置的链上存在区块数小于`gte_order_lifetime`时，不会被删除。

该CIP的目的是在UTC 0点时，可以删除已经到期的订单(即：订单设置的链上存在时间小于`gte_order_lifetime`个区块)
    
## 规则变更

`coinex-dex v0.1.0`版本及之前的订单引擎，删除订单时采用的规则：

*   ~~查询100000个区块之前的过期订单删除~~

该CIP实现的规则：

*   **查询区块链最新区块之前的过期订单进行删除**



