cip | title | author | status |
-------|-------|------|-------|
0001 | 修改交易对的创建、删除规则| | 草案|

## 概述

下文详细描述了在coinexdex公链中创建、删除交易对的规则。给各上层应用、以及token owner一个完整的规则指引。

## 动机

为了保证`coinexdex`链上token的流动性，保证用户手中的token始终可以处于交易的状态，增加了这些规则，来确保不会因为交易对的缺失，导致token 丧失流动性。

## 规则

### 交易对的创建

创建交易对时，需要满足如下规则之一

- 允许 `CET`作为`stock`，直接与链上的所有`token`建立交易对； 
	-   即： `CET/?`
- 允许任何`token`作为`stock`，与`CET`建立交易对；
	- 	即：`?/CET`
- 当`stock`与`money`都不为 `CET`时，交易对的成功，需要符合下列条件；
	- 存在`stock/CET`的交易对，且`stock/CET`的交易对不在删除队列；
	- 存在`cet/money`的交易对，且`cet/money`的交易对不在删除队列；
	- 符合上述两者任意一个规则，就允许创建 `stock/money`的交易对

### 交易对的删除

当删除交易对时，需要满足如下规则之一
	
- 对于`stock`与`money`都不为`CET`的交易对，可以直接删除
- 对于`money`为`CET`的交易对，删除时必须满足如下条件
	- 	不存在 `stock/CET`的bancor
	-  当`stock`必须具有全局禁止流通的属性；(对于不含有全局禁止流通属性的token，不允许下架交易对；需要交易对保证这个token的流动性，使持有该`stock`的用户可以随时去市场下单)
	-  查询所有的`stock/money?`的交易对；当不存在`stock/money?`交易对时，允许删除；存在时，获取所有的`money?`列表
		-  查询所有的`cet/money?`交易对，存在且不在删除列表时，允许删除`stock/cet`的交易对；只要有一个`cet/money?`不存在，或者`cet/money?`交易对在删除列表中，则不允许删除`stock/cet`的交易对。
- 对于`stock`为`CET`的交易对，删除时必须满足如下条件
	- 查询所有的`stock?/money`的交易对；不存在`stock?/money`交易对时，允许删除；存在时，获取所有的`stock?`列表；
		- 查询所有的`stock?/cet`的交易对，存在且不在删除列表时，允许删除`cet/money`的交易对对；只要有一个`stock?/cet`不存在，或者`stock?/cet`交易对在删除列表中，则不允许删除`cet/money`的交易对。


## 实现


